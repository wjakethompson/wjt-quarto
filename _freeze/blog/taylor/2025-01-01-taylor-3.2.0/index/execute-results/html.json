{
  "hash": "2fdad597c826ba346fc2f98a0609020c",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"taylor 3.2.0\"\ndate: 2025-01-13\nsubtitle: \"\"\ndescription: \"The chairman has cordially invited us to The Tortured Poets Department.\"\nimage: \"featured.jpg\"\ntwitter-card:\n  image: \"featured.jpg\"\nopen-graph:\n  image: \"featured.jpg\"\ncategories:\n  - R\n  - package\n  - taylor\n  - Taylor Swift\nengine: knitr\n---\n\n\n\nI'm so happy to announce the release of [taylor](https://taylor.wjakethompson.com) 3.2.0.\ntaylor provides data on Taylor Swift's discography, including lyrics from [Genius](https://genius.com/artists/Taylor-swift) and song characteristics from [Spotify](https://open.spotify.com/artist/06HL4z0CvFAxyc27GXpf02).\n\nYou can install the updated version from CRAN with:\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages(\"taylor\")\n```\n:::\n\nThis is a minor release to update the package following the end of The Eras Tour.\nThis blog post will highlight the changes in this release.\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(taylor)\n```\n:::\n\n## It's the end of an Era...\n\nThe primary update completion of the `eras_tour_surprise` data to include surprise songs from the European and final North American legs of The Eras Tour.\nYou can now find all surprise songs in [`eras_tour_surprise`](https://taylor.wjakethompson.com/reference/eras_tour_surprise.html).\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\neras_tour_surprise %>% \n  filter(leg == \"Europe\")\n#> # A tibble: 96 × 9\n#>    leg    date       city              night dress instrument song  mashup guest\n#>    <chr>  <date>     <chr>             <int> <chr> <chr>      <chr> <chr>  <chr>\n#>  1 Europe 2024-05-09 Paris, France         1 brig… guitar     Paris <NA>   <NA> \n#>  2 Europe 2024-05-09 Paris, France         1 brig… piano      loml  <NA>   <NA> \n#>  3 Europe 2024-05-10 Paris, France         2 ocea… guitar     Is I… Out O… <NA> \n#>  4 Europe 2024-05-10 Paris, France         2 ocea… piano      My B… <NA>   <NA> \n#>  5 Europe 2024-05-11 Paris, France         3 suns… guitar     Hey … <NA>   <NA> \n#>  6 Europe 2024-05-11 Paris, France         3 suns… piano      Maro… <NA>   <NA> \n#>  7 Europe 2024-05-12 Paris, France         4 ocea… guitar     The … Treac… <NA> \n#>  8 Europe 2024-05-12 Paris, France         4 ocea… piano      Begi… Paris  <NA> \n#>  9 Europe 2024-05-17 Stockholm, Sweden     1 brig… guitar     I Th… Gorge… <NA> \n#> 10 Europe 2024-05-17 Stockholm, Sweden     1 brig… piano      Peter <NA>   <NA> \n#> # ℹ 86 more rows\n\neras_tour_surprise %>% \n  filter(leg == \"North America (Leg 2)\")\n#> # A tibble: 36 × 9\n#>    leg                date       city  night dress instrument song  mashup guest\n#>    <chr>              <date>     <chr> <int> <chr> <chr>      <chr> <chr>  <chr>\n#>  1 North America (Le… 2024-10-18 Miam…     1 bett… guitar     Tim … Timel… <NA> \n#>  2 North America (Le… 2024-10-18 Miam…     1 bett… piano      this… Dayli… <NA> \n#>  3 North America (Le… 2024-10-19 Miam…     2 supe… guitar     Shou… I Did… <NA> \n#>  4 North America (Le… 2024-10-19 Miam…     2 supe… piano      loml  White… <NA> \n#>  5 North America (Le… 2024-10-20 Miam…     3 sunr… guitar     Out … All Y… <NA> \n#>  6 North America (Le… 2024-10-20 Miam…     3 sunr… piano      mirr… Guilt… <NA> \n#>  7 North America (Le… 2024-10-25 New …     1 koi … guitar     Our … Call … <NA> \n#>  8 North America (Le… 2024-10-25 New …     1 koi … piano      The … Haunt… <NA> \n#>  9 North America (Le… 2024-10-26 New …     2 suns… guitar     Espr… Is It… Sabr…\n#> 10 North America (Le… 2024-10-26 New …     2 suns… piano      Hits… Welco… <NA> \n#> # ℹ 26 more rows\n```\n:::\n\nUsing this data, we can, for example, look at the cumulative number of songs Taylor performed from each album over the course of the tour.\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Plot code\"}\nleg_labels <- unique(eras_tour_surprise$leg)\nleg_labels <- gsub(\"South America\", \"South\\nAmerica\", leg_labels)\n\nsurprise_song_count <- eras_tour_surprise %>%\n  nest(dat = -c(leg, date, city, night)) %>%\n  arrange(date) %>%\n  mutate(leg = factor(leg, levels = unique(eras_tour_surprise$leg),\n                      labels = leg_labels)) %>%\n  mutate(show_number = seq_len(n()), .after = night) %>%\n  unnest(dat) %>%\n  left_join(distinct(taylor_album_songs, track_name, album_name),\n            join_by(song == track_name),\n            relationship = \"many-to-one\") %>%\n  count(leg, date, city, night, show_number, album_name) %>%\n  complete(nesting(leg, date, city, night, show_number), album_name) %>%\n  mutate(n = replace_na(n, 0)) %>%\n  arrange(album_name, date, night) %>%\n  mutate(surprise_count = cumsum(n), .by = album_name) %>%\n  left_join(select(taylor_albums, album_name, album_release),\n            by = \"album_name\") %>%\n  mutate(surprise_count = case_when(\n    album_name == \"THE TORTURED POETS DEPARTMENT\" &\n      date < album_release ~ NA_integer_,\n    .default = surprise_count\n  )) %>%\n  add_row(leg = factor(\"Europe\"), album_name = \"THE TORTURED POETS DEPARTMENT\",\n          show_number = 83.5, surprise_count = 0L) %>%\n  mutate(album_name = replace_na(album_name, \"Other\"),\n         album_group = album_name,\n         album_name = factor(album_name, c(album_levels, \"Other\"),\n                             labels = c(gsub(\"POETS DEPARTMENT\",\n                                             \"POETS<br>DEPARTMENT\",\n                                             album_levels), \"Other\")))\n\nggplot(surprise_song_count) +\n  facet_wrap(~ album_name, ncol = 3, axes = \"all_x\") +\n  geom_line(data = ~select(.x, -album_name),\n            aes(x = show_number, y = surprise_count, group = album_group),\n            color = \"grey80\", na.rm = TRUE) +\n  geom_line(aes(x = show_number, y = surprise_count, color = album_group),\n            show.legend = FALSE, linewidth = 2, na.rm = TRUE) +\n  scale_color_albums(na.value = \"grey80\") +\n  scale_x_continuous(breaks = c(1, seq(30, 200, 30))) +\n  labs(x = \"Show\", y = \"Songs Played\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/eras-plot-1.png){fig-align='center' fig-alt='A horizontal bar graph showing track names on the y-axis and song energey on the x-axis. Bars a filled with colors derived from the TTPD color palette, ranging from a light grey to black.' width=90%}\n:::\n:::\n\nFinally, also inspired by some of Taylor's surprise song choices, [`taylor_all_songs`](https://taylor.wjakethompson.com/reference/taylor_songs.html) has been updated to include songs Taylor wrote, but is not the performer (e.g., \"This is What You Came For\" by Calvin Harris, featuring Rihanna).\n\n::: {.cell}\n\n```{.r .cell-code}\ntaylor_all_songs |> \n  filter(!str_detect(artist, \"Taylor Swift\"),\n         is.na(featuring) | !str_detect(featuring, \"Taylor Swift\"))\n#> # A tibble: 7 × 29\n#>   album_name ep    album_release track_number track_name        artist featuring\n#>   <chr>      <lgl> <date>               <int> <chr>             <chr>  <chr>    \n#> 1 <NA>       NA    NA                      NA 1 step forward, … \"Oliv… <NA>     \n#> 2 <NA>       NA    NA                      NA Best Days Of You… \"Kell… <NA>     \n#> 3 <NA>       NA    NA                      NA Better Man        \"Litt… <NA>     \n#> 4 <NA>       NA    NA                      NA deja vu           \"Oliv… <NA>     \n#> 5 <NA>       NA    NA                      NA This Is What You… \"Calv… Rihanna  \n#> 6 <NA>       NA    NA                      NA TMZ               \"\\\"We… <NA>     \n#> 7 <NA>       NA    NA                      NA You'll Always Fi… \"Hann… <NA>     \n#> # ℹ 22 more variables: bonus_track <lgl>, promotional_release <date>,\n#> #   single_release <date>, track_release <date>, danceability <dbl>,\n#> #   energy <dbl>, key <int>, loudness <dbl>, mode <int>, speechiness <dbl>,\n#> #   acousticness <dbl>, instrumentalness <dbl>, liveness <dbl>, valence <dbl>,\n#> #   tempo <dbl>, time_signature <int>, duration_ms <int>, explicit <lgl>,\n#> #   key_name <chr>, mode_name <chr>, key_mode <chr>, lyrics <list>\n```\n:::\n\n\n## Minor Changes\n\nThere were also a couple of minor improvements:\n\n* Error messages and color palette displays have been improved thanks to [@olivroy](https://github.com/wjakethompson/taylor/pull/49)\n* Spotify data for \"Half Of My Heart\" has been removed, as the version featuring Taylor Swift is no longer available.\n\nFor a complete list of changes, check out the [changelog](https://taylor.wjakethompson.com/news/index.html#taylor-320).\n\n## Acknowledgments {.appendix}\n\nFeatured photo by <a href=\"https://unsplash.com/@myriamzilles?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash\">Myriam Zilles</a> on <a href=\"https://unsplash.com/photos/yellow-fireworks-in-the-sky-during-nighttime-L3FwT4qMeT0?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash\">Unsplash</a>.\nm\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}